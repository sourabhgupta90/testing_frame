from reportlab.lib.units import mm
from reportlab.graphics.barcode import code39
from reportlab.lib.styles import getSampleStyleSheet
from reportlab.lib.pagesizes import letter, A4 ,inch
from reportlab.platypus import *
from reportlab.lib import colors
from reportlab.pdfgen import canvas 


# Our container for 'Flowable' objects
elements = []
 
# A large collection of style sheets pre-made for us
styles = getSampleStyleSheet()
 
# A basic document for us to write to 'rl_hello_table.pdf'
doc = SimpleDocTemplate('rl_hello_table.pdf')
 
elements.append(Paragraph("Wumpus vs Cave Population Report",
 styles['Title']))
 
data = [['Caves',         'Wumpus Population'],
        ['Deep Ditch',    50],
        ['Death Gully',   5000],
        ['Dire Straits',  600],
        ['Deadly Pit',    5],
        ['Conclusion',    'Run!']]
 
# First the top row, with all the text centered and in Times-Bold,
# and one line above, one line below.
ts = [('ALIGN', (1,1), (-1,-1), 'CENTER'),
     ('LINEABOVE', (0,0), (-1,0), 1, colors.purple),
     ('LINEBELOW', (0,0), (-1,0), 1, colors.purple),
     ('FONT', (0,0), (-1,0), 'Times-Bold'),
 
# The bottom row has one line above, and three lines below of
# various colors and spacing.
     ('LINEABOVE', (0,-1), (-1,-1), 1, colors.purple),
     ('LINEBELOW', (0,-1), (-1,-1), 0.5, colors.purple,
      1, None, None, 4,1),
     ('LINEBELOW', (0,-1), (-1,-1), 1, colors.red),
     ('FONT', (0,-1), (-1,-1), 'Times-Bold')]

logo = "python_logo.png"
im = Image(logo, 2*inch, 2*inch)
elements.append(im)

# Create the table with the necessary style, and add it to the
# elements list.
elements.append(Spacer(1, 50)) 
table = Table(data, style=ts)
elements.append(table)

# Write the document to disk
#doc.build(elements)

p = canvas.Canvas("rl_hello_table.pdf",bottomup = 0 ,pagesize=A4 )
f = Frame(inch, inch, 6*inch, 10*inch)

f.addFromList(elements,p) 
p.drawString(100,100,"Hello World")
 
 
barcode=code39.Extended39("123456789",barWidth=0.2*mm,barHeight=10*mm)
# drawOn puts the barcode on the canvas at the specified coordinates
barcode.drawOn(p,100*mm,50*mm)
 
 
p.showPage()
p.save()
